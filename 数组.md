# 数组

#### 数组逆置

就是将数组元素原来的顺序进行颠倒，让第一个数组元素变为最后一个，最后一个数组元素变为第一个，让第二个变为倒数第二个，倒数第二个变为第二个，以此类推，可以将数组首尾对应位置的数组元素进行交换，如下：

```c
for(i=0,j=n-1 ;
i<j; i++, j--)
{    
t=a[i];
a[i]=a[j];
a[j]=t;
}
```

 下标`i`初始指向数组起始的位置，下标`j`指向数组最后一个元素的位置，交换`i`和`j`位置对应的数组元素，然后 `i`往后移动，`j`往前移动，请大家思考，上述循环是单循环，还是双层循环。



要将给定的元素`x`插入到有`n`个从小到大排好序的数组`a`中合适的位置，以保持结果依然有序，有两种常用方法。

##### 方法一：

1. 定义数组`a`时有多余的存储单元；
2. 查找合适的插入位置`j`； ![ 在有序数组查找插入位置 ](https://data.educoder.net/api/attachments/1620238)

```c
while( a[j]<=x && j<n )
{    
j++;   //找不到比x大的元素时也要退出循环 
}
```

1. 向右移动插入点后的元素：先把`a[n-1]`移到`a[n]`，`a[n-2]`移到`a[n-1]`，…，`a[i]`移到`a[i+1]`，直到把`a[j]`移到`a[j+1]`，即在`i=j`时停止移动元素；

![ 在有序数组移动数据 ](https://data.educoder.net/api/attachments/1620251)

```c
for(i=n-1;i>=j;i-- )
{    
a[i+1]=a[i];
}
```

1. 将

   ```c
   x
   ```

   插入到数组

   ```c
   a
   ```

   中下标为

   ```c
   j
   ```

   的位置。

   ```c
   a[j]=x;
   ```

##### 方法二：

1. 从数组最后一个元素开始，将要插入的数据`x`与数组最后一个元素比较，如果小于数组的元素，将数组元素向后移动一位，给倒数第二个向后移的数据腾出位置;

2. 然后再将`x`与数组倒数第二个元素比较，如果比数组元素小，数组元素继续向后移动一位，以此类推；

3. 如果`x`比数组元素大，则跳出循环；

   ```c
   for(i=n-1;i>=0;i--)
   { 
   if(a[i]>x)   
   a[i+1]=a[i]; 
   else   
   break;    
   }
   ```

4. 将`x`插入到相应位置。

    `a[i+1]=x;`

##### 比较相邻的元素

如果第一个比第二个大，就交换他们两个，对每一对相邻元素做同样的工作，从开始第一对到结尾的最后一对，最后的元素应该会是最大的数。

 如果有长度为3的数组a，三个数组元素`a[0]`，`a[1]`，`a[2]`，编写程序求这`3`个数组元素中的最大者。 解题思路： 1）如果 `a[0]>a[1]`，`a[0]`和`a[1]`交换，`a[1]`是`a[0]`、`a[1]`中的大者。 2）如果 `a[1]>a[2]`，`a[1]`和`a[2]`交换，`a[2]`是三者中最大者。

用`if`语句表示如下：

```c
if(a[0]>a[1])
{
t=a[0];    
a[0]=a[1];    
a[1]=t;         //a[0]和a[1]交换
} 
if(a[1]>a[2])
{   
t=a[1];    
a[1]=a[2];    
a[2]=t;         //a[1]和a[2]交换 
} 
```

#### 二维数组的定义

在实际问题中有很多变量是二维的或多维的，因此Ｃ语言允许构造多维数组。多维数组元素有多个下标，以标识它在数组中的位置，多维数组可由二维数组类推而得到。

二维数组定义的一般形式是：

类型说明符 数组名[常量表达式1][常量表达式2]

其中`常量表达式1`表示第一维下标的长度，`常量表达式2`表示第二维下标的长度。例如：     `int a[3][4];` 说明了一个 3 行 4 列的数组，数组名为a，其下标变量的类型为整型。该数组的数组元素共有3×4个，即：     `a[0][0],a[0][1],a[0][2],a[0][3]`     `a[1][0],a[1][1],a[1][2],a[1][3]`     `a[2][0],a[2][1],a[2][2],a[2][3]`

二维数组在概念上是二维的，其下标在两个方向上变化，下标变量在数组中的位置也处于一个平面之中，但是，实际的硬件存储器却是连续编址的，也就是说存储器单元是按一维线性排列的。

如何在一维存储器中存放二维数组，可有两种方式：一种是按行存放， 即放完一行之后顺次放入第二行。另一种是按列存放，即存放完一列之后再顺次存储第二列。

在Ｃ语言中，二维数组是按行排列的。即先存放第1行，再存放第2行，最后存放第3行。每行中的元素也是依次存放。

上述二维数组的元素排列顺序为：

 `a[0][0]→a[0][1]→a[0][2]→a[0][3]→a[1][0]→a[1][1]→a[1][2]→a[1][3]→a[2][0]→a[2][1]→a[2][2]→a[2][3]`

C语言还允许使用多维数组。有了二维数组的基础，再掌握多维数组是不困难的。例如，定义三维数组的方法如下：

```c
float a[2][3][4];   //定义三维数组a，它有2页，3行，4列
```

#### 二维数组的引用

二维数组的元素的表示形式： 数组名［下标］［下标］   

注意：

1. 下标可以是整数，也可以是整型表达式；
2. 数组元素可以出现在表达式中，也可以赋值。
3. 在使用数组元素时，应该注意下标值应在已定义的数组大小的范围内。

#### 二维数组的初始化

1. 分行给二维数组赋初值。如： `int a[3][4]= {{1,2,3,4},{5,6,7,8},{9,10,11,12}};`
2. 可以将所有数据写在一个花括弧内，按数组排列的顺序对各元素赋初值。如： ` int a[3][4]= {1,2,3,4,5,6,7,8,9,10,11,12};`
3. 可以对部分元素赋初值。 如： `int a[3][4]= {{1},{0,6},{0,0,11}}; ` 
4. 如果对全部元素都赋初值（即提供全部初始数据），则定义数组时对第一维的长度可以不指定，但第二维的长度不能省。如： `int a[3][4]= {1,2,3,4,5,6,7,8,9,10,11,12};  `

与下面的定义等价： `int a[ ][4]= {1,2,3,4,5,6,7,8,9,10,11,12};`

在定义时，也可以只对部分元素赋初值而省略第一维的长度，但应分行赋初值。如：  `int a[ ][4]={{0,0,3},{ },{0,10}}; `

数组是一种构造类型的数据。二维数组可以看作是由一维数组的嵌套而构成的。设一维数组的每个元素都又是一个数组，就组成了二维数组。

当然，前提是各数组元素类型必须相同。一个二维数组也可以分解为多个一维数组。Ｃ语言允许这种分解，如二维数组`a[3][4]`，可分解为三个一维数组，其数组名分别为：`a[0]`，`a[1]`，`a[2]`。

对这3个一维数组不需另作说明即可使用。这3个一维数组都有4个元素，例如： 一维数组`a[0]`的元素为：`a[0][0]`,`a[0][1]`,`a[0][2]`,`a[0][3]`。

必须强调的是，`a[0]`，`a[1]`，`a[2]`不能当作数组元素使用，它们是数组名，不是单纯的数组元素。

#### 动态数组

定义函数分别完成动态数组的创建，关键是怎么将在函数体里申请数组的首地址和数组的长度带到函数体外。 　定义学生数据类型及输入输出函数如下：

```c
typedef struct date
{      
    int year;    
    int month;    
    int day;
}DATE;
typedef struct student
{     
    int num;    
    char name[20];     
    char sex;    
    DATE birthday;    
    float score;
}STUDENT;
void input(STUDENT *s)
{
    //printf("请输入学生学号:");
    scanf("%d",&(s->num));  
    //printf("请输入学生姓名:"); 
    scanf("%s", s->name); 
    //printf("请输入学生性别:"); 
    scanf(" %c",&( (*s) . sex));  
    //printf("请输入学生出生日期:"); 
    scanf("%d%d%d",&s->birthday.year, &s->birthday.month, &s-> birthday.day);
    //printf("请输入学生成绩:"); 
    scanf("%f",&(s-> score));  
}
void output(STUDENT s)
{ 
    printf("学号:%d\t姓名:%s\t性别:%c\t", s.num,s.name,s.sex);  
    printf("出生日期:%d-%d-%d \t", s.birthday.year,s.birthday.month, s.birthday.day);  
    printf("成绩:%.1f\n", s.score);
}
```

　　动态数组的输入输出处理都可以模块化，我们希望定义函数创建动态数组，关键是怎么将在函数体里申请的**数组的首地址**和**数组的长度**带到函数体外。 　定义创建动态数组的函数如下：

```c
void createarr(STUDENT **s,int *n)
{    
    scanf("%d",n);
    *s=( STUDENT *) malloc( (*n) * sizeof (STUDENT) ); 
    if( *s == NULL)  
    {      
        printf("不能成功分配存储空间。\n");  
        exit(1); 
    }
}
```

#### 静态数组和动态数组

静态数组的大小必须是预先定义好的，在整个程序中，一旦给定大小后就无法改变。例如：

```c
int n;scanf("%d",&n);
int a[n];                 //编译错误
```

　　Ｃ 语言不允许在定义数组时用变量表示大小，但是在实际的编程中，往往会发生这种情况，所需数组的大小取决于实际输入的数据，而无法预先确定。如果希望在程序运行时决定数组的大小，可以利用 C 语言提供的内存管理函数，根据实际需要动态地分配内存空间。构建动态数组，也可以把不再使用的空间回收待用，从而有效地提高内存资源的利用率。

　　利用`malloc()`函数可在堆区创建了一个长度为`10`的`int`类型数组所需内存区域，可通过地址对此数组进行输入和输出，例如：

```c
int *p;p=(int *)malloc(10*sizeof(int)); //p指向堆区的一个无名的长度为10的int型数组
for(i=0;i<10;i++)  scanf(“%d”,&p[i]);          // &p[i]等价于
p+ifor(i=0;i<10;i++)  printf(“%d,”,p[i]);          // p[i]等价于*(p+i) 
```

　　C 语言还提供`calloc() `函数用于分配内存空间，调用形式如下所示：

```c
(类型说明符*)calloc(n,size)
```

　　功能：在内存动态存储区中，分配`n`块长度为`size`字节的连续区域。函数的返回值为该区域的首地址。例如：

```c
p = (int*) calloc( 10, sizeof(int) );
```

　　类似于：

```c
p = (int *) malloc( 10*sizeof(int) );
```

　　`calloc()`函数可以一次以类型大小为单位，申请分配`n`块区域并初始化为`0`， `malloc()`函数分配的内存没有初始化。